"use strict";(globalThis["webpackChunkemarket"]=globalThis["webpackChunkemarket"]||[]).push([[923],{649:(t,e,a)=>{a.d(e,{Z:()=>S});var o=a(9835),l=a(6970);const i={class:"q-pr-sm"};function s(t,e,a,s,r,d){const n=(0,o.up)("q-th"),c=(0,o.up)("q-tr"),u=(0,o.up)("q-icon"),m=(0,o.up)("q-item-section"),p=(0,o.up)("q-item-label"),g=(0,o.up)("q-item"),h=(0,o.up)("q-list"),f=(0,o.up)("q-btn-dropdown"),w=(0,o.up)("q-btn"),b=(0,o.up)("q-td"),y=(0,o.up)("q-input"),q=(0,o.up)("q-table"),_=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(q,{title:t.title,rows:t.rows,columns:t.columns,filter:t.filter,"rows-per-page-options":t.rowsPerPage,"row-key":t.rowKey,style:(0,l.j5)(t.height>0?`height: ${t.height}px`:"")},(0,o.Nv)({_:2},[t.actions.length>0?{name:"header",fn:(0,o.w5)((t=>[(0,o.Wm)(c,{props:t},{default:(0,o.w5)((()=>[(0,o.Wm)(n,{"auto-width":""}),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.cols,(e=>((0,o.wg)(),(0,o.j4)(n,{key:e.name,props:t},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e.label),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])]))}:void 0,t.actions.length>0?{name:"body",fn:(0,o.w5)((e=>[(0,o.Wm)(c,{props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{"auto-width":""},{default:(0,o.w5)((()=>[t.actions.length>1?((0,o.wg)(),(0,o.j4)(f,{key:0,size:"sm",color:"primary"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.actions,((t,a)=>(0,o.wy)(((0,o.wg)(),(0,o.j4)(g,{key:a,clickable:"",onClick:a=>t.action(e.row)},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{avatar:""},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{color:"primary",name:t.icon},null,8,["name"])])),_:2},1024),(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(t.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])),[[_]]))),128))])),_:2},1024)])),_:2},1024)):((0,o.wg)(),(0,o.j4)(w,{key:1,dense:"",class:(0,l.C_)(t.actions[0].class),onClick:a=>t.actions[0].action(e.row),flat:"","icon-right":t.actions[0].icon,size:"md"},{default:(0,o.w5)((()=>[(0,o._)("span",i,(0,l.zw)(t.actions[0].label),1)])),_:2},1032,["class","onClick","icon-right"]))])),_:2},1024),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cols,(t=>((0,o.wg)(),(0,o.j4)(b,{key:t.name,props:e},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(t.value),1)])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])]))}:void 0,t.showFilter?{name:"top-right",fn:(0,o.w5)((()=>[(0,o.Wm)(y,{borderless:"",dense:"",debounce:"300",modelValue:t.filter,"onUpdate:modelValue":e[0]||(e[0]=e=>t.filter=e),placeholder:"Pesquisar"},{append:(0,o.w5)((()=>[(0,o.Wm)(u,{name:"search"})])),_:1},8,["modelValue"])]))}:void 0]),1032,["title","rows","columns","filter","rows-per-page-options","row-key","style"])}var r=a(499);const d=(0,o.aZ)({name:"DataTable",props:{title:{type:String,required:!0},rows:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},rowKey:{type:String,default:"id"},actions:{type:Array,default:()=>[]},rowsPerPage:{type:Array,default:()=>[5,10,25,50,100]},height:{type:Number,default:0},showFilter:{type:Boolean,default:!0}},setup(){const t=(0,r.iH)("");return{filter:t}}});var n=a(1639),c=a(1746),u=a(9546),m=a(1682),p=a(7220),g=a(8479),h=a(3246),f=a(490),w=a(1233),b=a(2857),y=a(3115),q=a(8879),_=a(6611),v=a(2146),k=a(9984),x=a.n(k);const Z=(0,n.Z)(d,[["render",s]]),S=Z;x()(d,"components",{QTable:c.Z,QTr:u.Z,QTh:m.Z,QTd:p.Z,QBtnDropdown:g.Z,QList:h.Z,QItem:f.Z,QItemSection:w.Z,QIcon:b.Z,QItemLabel:y.Z,QBtn:q.Z,QInput:_.Z}),x()(d,"directives",{ClosePopup:v.Z})},9335:(t,e,a)=>{a.d(e,{Z:()=>x});var o=a(9835),l=a(6970);const i={class:"text-h6"},s=(0,o._)("div",{class:"offset-md-2"},null,-1),r=(0,o._)("span",{class:"q-pl-sm"}," Voltar ",-1),d=(0,o._)("span",{class:"q-pr-sm"}," Salvar ",-1),n=(0,o._)("div",{class:"offset-md-2"},null,-1);function c(t,e,a,c,u,m){const p=(0,o.up)("q-space"),g=(0,o.up)("q-btn"),h=(0,o.up)("q-bar"),f=(0,o.up)("q-form"),w=(0,o.up)("q-card-section"),b=(0,o.up)("q-card-actions"),y=(0,o.up)("q-card"),q=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(q,{modelValue:t.dialogOpened,"onUpdate:modelValue":e[0]||(e[0]=e=>t.dialogOpened=e),maximized:!0,persistent:"","transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{class:"bg-white"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{class:"bg-primary text-white q-pa-lg"},{default:(0,o.w5)((()=>[(0,o._)("div",i,(0,l.zw)(t.title),1),(0,o.Wm)(p),(0,o.Wm)(g,{onClick:t.cancelButton,dense:"",flat:"",icon:"close",size:"md",disable:t.loading},null,8,["onClick","disable"])])),_:1}),(0,o.Wm)(w,{class:"q-pt-lg"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{onSubmit:t.submitForm,ref:"form",class:"row"},{default:(0,o.w5)((()=>[(0,o._)("div",{class:"col-12 col-sm-8 offset-sm-2 q-pa-sm q-pt-lg q-pb-lg",style:(0,l.j5)(`background-color: ${t.background}`)},[(0,o.WI)(t.$slots,"default")],4)])),_:3},8,["onSubmit"])])),_:3}),(0,o.Wm)(b,{style:{"border-top":"1px solid lightgray"},align:"right",class:"bg-white text-teal q-pa-md q-mb-sm q-mt-md"},{default:(0,o.w5)((()=>[s,(0,o.Wm)(g,{class:"text-black",style:{"background-color":"#cfcfcf"},onClick:t.cancelButton,flat:"",icon:"arrow_back_ios",size:"md",disable:t.loading},{default:(0,o.w5)((()=>[r])),_:1},8,["onClick","disable"]),(0,o.Wm)(p),t.showSaveButton?((0,o.wg)(),(0,o.j4)(g,{key:0,class:"bg-positive text-white",onClick:t.saveButton,flat:"","icon-right":"save",size:"md",disable:t.loading,loading:t.loading},{default:(0,o.w5)((()=>[d])),_:1},8,["onClick","disable","loading"])):(0,o.kq)("",!0),n])),_:1})])),_:3})])),_:3},8,["modelValue"])}const u=(0,o.aZ)({name:"FormDialog",data(){return{dialogOpened:this.dialog,loading:!1}},methods:{async submitForm(){this.loading=!0;let t=await this.save();1==t&&this.closeModal(),this.loading=!1},saveButton(){this.$refs.form.submit()},cancelButton(){this.cancel(),this.closeModal()},closeModal(){this.loading=!1,this.$emit("update:dialog",!1)}},watch:{dialog(t){this.dialogOpened=t}},props:{title:{type:String,default:""},dialog:{type:Boolean,default:!1},save:{type:Function,default:()=>{}},cancel:{type:Function,default:()=>{}},showSaveButton:{type:Boolean,default:!0},background:{type:String,default:"#ededed"}}});var m=a(1639),p=a(2074),g=a(4458),h=a(4526),f=a(136),w=a(8879),b=a(3190),y=a(8326),q=a(1821),_=a(9984),v=a.n(_);const k=(0,m.Z)(u,[["render",c]]),x=k;v()(u,"components",{QDialog:p.Z,QCard:g.Z,QBar:h.Z,QSpace:f.Z,QBtn:w.Z,QCardSection:b.Z,QForm:y.Z,QCardActions:q.Z})},3923:(t,e,a)=>{a.r(e),a.d(e,{default:()=>J});var o=a(9835),l=a(6970);const i={class:"q-pa-md"},s={class:"row q-mt-sm"},r={class:"col-12 col-md-10 offset-md-1"},d={key:0},n={class:"text-h6",style:{"text-transform":"uppercase"}},c={class:"text-subtitle2",style:{color:"whitesmoke","margin-top":"10px"}},u={key:1},m=(0,o._)("div",{class:"text-h6"},"Escolha um produto...",-1),p=[m],g={key:0,class:"col-12 col-md-4 text-right"},h={class:"text-h6 text-bold",style:{"text-transform":"uppercase"}},f={class:"text-subtitle2",style:{color:"whitesmoke","margin-top":"10px"}},w={class:"col-12 col-md-3 q-pa-sm"},b=(0,o._)("span",{class:"q-pl-sm"}," Escolher ",-1),y=(0,o._)("span",{class:"q-pl-sm"}," Cancelar Produto ",-1),q={class:"col-12 col-md-2 offset-md-4 q-pa-sm"},_={class:"col-12 col-md-3 q-pa-sm"},v=(0,o._)("span",{class:"q-pl-sm"}," Adicionar à venda ",-1),k={class:"row q-mt-md"},x={class:"col-12 col-md-10 offset-md-1"},Z={class:"row q-mt-md"},S={class:"col-12 col-md-10 offset-md-1"},F=(0,o._)("div",{class:"col-12 col-md-8"},[(0,o._)("div",{class:"text-h6"},"SUBTOTAL")],-1),W={class:"col-12 col-md-4 text-right"},Q={class:"text-h6 text-bold",style:{"text-transform":"uppercase"}},P={class:"text-subtitle2",style:{color:"whitesmoke","margin-top":"10px"}},C={class:"col-12 col-md-3"},D=(0,o._)("span",{class:"q-pl-sm"}," Fechar Venda ",-1),$={class:"row"},z={class:"col-12 col-md-12"};function I(t,e,a,m,I,T){const B=(0,o.up)("q-card-section"),V=(0,o.up)("q-separator"),L=(0,o.up)("q-btn"),j=(0,o.up)("q-input"),A=(0,o.up)("q-card-actions"),N=(0,o.up)("q-card"),R=(0,o.up)("DataTable"),O=(0,o.up)("q-page"),U=(0,o.up)("FormDialog");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(O,null,{default:(0,o.w5)((()=>[(0,o._)("div",i,[(0,o._)("div",s,[(0,o._)("div",r,[(0,o.Wm)(N,{class:"my-card full-width non-selectable"},{default:(0,o.w5)((()=>[(0,o.Wm)(B,{class:"row bg-primary text-white",style:{"min-height":"100px"}},{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,l.C_)(t.thereIsSelectedProduct?"col-12 col-md-8":"col-12")},[t.thereIsSelectedProduct?((0,o.wg)(),(0,o.iD)("div",d,[(0,o._)("div",n,(0,l.zw)(this.product.name),1),(0,o._)("div",c," Ref. "+(0,l.zw)(this.product.reference),1)])):((0,o.wg)(),(0,o.iD)("div",u,p))],2),t.thereIsSelectedProduct?((0,o.wg)(),(0,o.iD)("div",g,[(0,o._)("div",h," R$ "+(0,l.zw)(parseFloat(this.product.price*this.quantity).toLocaleString("pt-br",{minimumFractionDigits:2})),1),(0,o._)("div",f," Impostos: R$ "+(0,l.zw)(parseFloat((this.product.price*this.product.tax/100*this.quantity).toFixed(2)).toLocaleString("pt-br",{minimumFractionDigits:2})),1)])):(0,o.kq)("",!0)])),_:1}),(0,o.Wm)(V),(0,o.Wm)(A,{align:"left"},{default:(0,o.w5)((()=>[(0,o._)("div",w,[t.thereIsSelectedProduct?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(L,{key:0,disabled:t.loading,onClick:t.openProductModal,class:"bg-primary text-white full-width",flat:"",icon:"view_list",size:"md"},{default:(0,o.w5)((()=>[b])),_:1},8,["disabled","onClick"])),t.thereIsSelectedProduct?((0,o.wg)(),(0,o.j4)(L,{key:1,disabled:t.loading,onClick:t.clearForm,class:"bg-negative text-white full-width",flat:"",icon:"block",size:"md"},{default:(0,o.w5)((()=>[y])),_:1},8,["disabled","onClick"])):(0,o.kq)("",!0)]),(0,o._)("div",q,[(0,o.Wm)(j,{readonly:!t.thereIsSelectedProduct,dense:"",modelValue:t.quantity,"onUpdate:modelValue":e[0]||(e[0]=e=>t.quantity=e),modelModifiers:{number:!0},type:"number",min:"1",max:t.maxProductQuantity,onKeypress:t.forceValue,class:"q-mr-sm full-width",label:"Quantidade",outlined:""},null,8,["readonly","modelValue","max","onKeypress"])]),(0,o._)("div",_,[(0,o.Wm)(L,{disabled:!t.thereIsSelectedProduct||t.quantity<=0||t.loading,onClick:t.addProduct,class:"bg-positive text-white full-width",flat:"",icon:"add",size:"md"},{default:(0,o.w5)((()=>[v])),_:1},8,["disabled","onClick"])])])),_:1})])),_:1})])]),(0,o._)("div",k,[(0,o._)("div",x,[(0,o.Wm)(R,{title:"Venda",columns:t.columnsSale,rows:t.products,"row-key":"name",actions:t.saleActions,rowsPerPage:[0],virtualScroll:!0,height:250,filter:null,"filter-method":null,showFilter:!1,"hide-no-data":"","hide-pagination":"","hide-bottom":"","virtual-scroll":"",dense:""},null,8,["columns","rows","actions"])])]),(0,o._)("div",Z,[(0,o._)("div",S,[(0,o.Wm)(N,{class:"my-card full-width non-selectable"},{default:(0,o.w5)((()=>[(0,o.Wm)(B,{class:"row bg-secondary text-white",style:{"min-height":"100px"}},{default:(0,o.w5)((()=>[F,(0,o._)("div",W,[(0,o._)("div",Q," R$ "+(0,l.zw)(parseFloat(t.totalPrice).toLocaleString("pt-br",{minimumFractionDigits:2})),1),(0,o._)("div",P," Impostos: R$ "+(0,l.zw)(parseFloat(t.totalTax.toFixed(2)).toLocaleString("pt-br",{minimumFractionDigits:2})),1)])])),_:1}),(0,o.Wm)(V),(0,o.Wm)(A,{align:"right"},{default:(0,o.w5)((()=>[(0,o._)("div",C,[(0,o.Wm)(L,{disabled:t.products.length<=0||t.loading,loading:t.loading,onClick:t.save,class:"bg-positive text-white full-width",flat:"",icon:"done",size:"md"},{default:(0,o.w5)((()=>[D])),_:1},8,["disabled","loading","onClick"])])])),_:1})])),_:1})])])])])),_:1}),(0,o.Wm)(U,{title:"Selecione o Produto",dialog:t.dialog,"onUpdate:dialog":e[1]||(e[1]=e=>t.dialog=e),showSaveButton:!1,background:"white"},{default:(0,o.w5)((()=>[(0,o._)("div",$,[(0,o._)("div",z,[(0,o.Wm)(R,{title:"Produtos",columns:t.columns,rows:t.productsOptions,actions:t.productActions},null,8,["columns","rows","actions"])])])])),_:1},8,["dialog"])],64)}a(6727);var T=a(649),B=a(9335),V=a(1569);const L=(0,o.aZ)({name:"SalePage",data(){return{productsLoaded:[],dialog:!1,productActions:[{label:"",icon:"chevron_right",class:"bg-positive text-white",action:t=>{this.dialog=!1,this.product=t}}],saleActions:[{label:"",icon:"remove",class:"bg-negative text-white",action:t=>{let e=this.products.indexOf(t);this.products.splice(e,1)}}],product:null,quantity:1,products:[],loading:!1}},computed:{thereIsSelectedProduct(){return null!=this.product},maxProductQuantity(){return this.thereIsSelectedProduct?this.product.stock_amount:1e4},productsOptions(){let t=this.products.map((t=>t.product.id)),e=this.productsLoaded.filter((e=>!t.includes(e.id)));return e},totalPrice(){let t=0;for(var e in this.products){var a=this.products[e];t+=a.product.price*a.quantity}return t},totalTax(){let t=0;for(var e in this.products){var a=this.products[e];t+=a.product.price*a.product.tax/100*a.quantity}return t}},methods:{save(){this.loading=!0,setTimeout((async()=>{let t={products:this.products.map((function(t){return{id:t.product.id,quantity:t.quantity}}))},e=await V.api.post("/sale/create",t);e.data.ok?(this.$q.notify({type:"positive",position:"bottom",message:"Venda salva com sucesso!",timeout:2e3}),this.clearForm(),this.products=[]):this.$q.notify({type:"warning",position:"bottom",message:e.data.msg,timeout:2e3}),this.loading=!1}),1e3)},forceValue(t){setTimeout((()=>{this.quantity>this.maxProductQuantity?(this.quantity=this.maxProductQuantity,t.preventDefault()):this.quantity<=0&&(this.quantity=1,t.preventDefault())}),100)},addProduct(){let t={product:this.product,quantity:this.quantity};this.products=[t].concat(this.products),this.clearForm()},clearForm(){this.product=null,this.quantity=1},openProductModal(){this.loadData(),this.dialog=!0},loadData(){V.api.get("/product/list/1").then((t=>{this.productsLoaded=t.data.data}))}},setup(){const t=[{name:"id",required:!0,label:"Cód.",align:"center",field:t=>t.id,format:t=>`${t}`,sortable:!0},{name:"name",required:!0,label:"Nome",align:"left",field:t=>t.name,format:t=>`${t}`,sortable:!0},{name:"reference",required:!0,label:"Referência",align:"left",field:t=>t.reference,format:t=>`${t}`,sortable:!0},{name:"name_product_type",required:!0,label:"Tipo",align:"left",field:t=>t.name_product_type,format:t=>`${t}`,sortable:!0},{name:"price",required:!0,label:"Preço",align:"right",field:t=>t.price,format:t=>{var e=parseFloat(t);return isNaN(e)?"-":`R$ ${e.toLocaleString("pt-br",{minimumFractionDigits:2})}`},sortable:!0},{name:"stock_amount",required:!0,label:"Estoque (un.)",align:"right",field:t=>t.stock_amount,format:t=>`${t}`,sortable:!0}],e=[{name:"name",required:!0,sortable:!1,label:"Nome",align:"left",field:t=>t.product.name,format:t=>`${t}`},{name:"reference",required:!0,sortable:!1,label:"Referência",align:"left",field:t=>t.product.reference,format:t=>`${t}`},{name:"price",required:!0,sortable:!1,label:"Preço",align:"right",field:t=>t.product.price,format:t=>{var e=parseFloat(t);return isNaN(e)?"-":`R$ ${e.toLocaleString("pt-br",{minimumFractionDigits:2})}`}},{name:"quantity",required:!0,sortable:!1,label:"Quantidade",align:"right",field:t=>t.quantity,format:t=>`${t}`},{name:"total",required:!0,sortable:!1,label:"Total",align:"right",field:t=>t.product.price*t.quantity,format:t=>{var e=parseFloat(t.toFixed(2));return isNaN(e)?"-":`R$ ${e.toLocaleString("pt-br",{minimumFractionDigits:2})}`}},{name:"tax",required:!0,sortable:!1,label:"Impostos",align:"right",field:t=>t.product.price*t.quantity*t.product.tax/100,format:t=>{var e=parseFloat(t.toFixed(2));return isNaN(e)?"-":`R$ ${e.toLocaleString("pt-br",{minimumFractionDigits:2})}`}}];return{columns:t,columnsSale:e}},components:{DataTable:T.Z,FormDialog:B.Z,DataTable:T.Z}});var j=a(1639),A=a(9885),N=a(4458),R=a(3190),O=a(926),U=a(1821),K=a(8879),M=a(6611),H=a(8149),Y=a(9984),E=a.n(Y);const G=(0,j.Z)(L,[["render",I]]),J=G;E()(L,"components",{QPage:A.Z,QCard:N.Z,QCardSection:R.Z,QSeparator:O.Z,QCardActions:U.Z,QBtn:K.Z,QInput:M.Z,QField:H.Z})}}]);